
```ts
  const MAX_SUMMARY_LENGTH = 80; // maximum length of summary, in characters 
  let summary = '';
  let count = 0;

  // Split contentHtml into Chinese and English words
  const chineseRegex = /[\u4e00-\u9fa5]/g;
  const englishRegex = /[a-zA-Z]+/g;
  const chineseWords: string[] = NoImages.match(chineseRegex) || [];
  const englishWords: string[] = NoImages.match(englishRegex) || [];
  const words = chineseWords.concat(englishWords);

  // Add words to summary until max length is reached
  for (let i = 0; i < words.length; i++) {
    const word = words[i];

    // Use regular expression to remove contents of h1 to h6 tags inside summary
    let sanitizedWord = word;
    const headingMatch = sanitizedWord.match(/^<h[1-6][^>]*>(.*)<\/h[1-6]>$/i);
    if (headingMatch) {
      sanitizedWord = headingMatch[1].trim();
    }

    if (count + sanitizedWord.length > MAX_SUMMARY_LENGTH) {
      break;
    }

    summary += sanitizedWord;
    count += sanitizedWord.length;
  }
```

